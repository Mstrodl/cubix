#!/usr/bin/env lua
--/bin/ls : wrapper to CC "ls"

_handler = {}
_handler.signal_handler = function(sig)
    if sig == 'kill' then
        --print("ls: SIGKILL")
        return 0
    end
end

function main(args)
    local p = args[1]
    cpth = fs.open("/tmp/current_path", 'r')
    cpath = cpth.readAll()
    cpth.close()

    if p == nil then
        os.runfile("ls "..cpath)
    elseif fs.exists(p) then
        os.runfile("ls "..p)
    elseif fs.exists(fs.combine(cpath, p)) then
        os.runfile("ls "..fs.combine(cpath, p))
    end
end

